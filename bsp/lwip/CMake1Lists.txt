cmake_minimum_required(VERSION 3.5)

project(lwip)

set(LWIP_SOURCE_DIR ${CMAKE_SOURCE_DIR}/lwip)

file(GLOB_RECURSE LWIP_SOURCES 
    ${LWIP_SOURCE_DIR}/src/core/*.c
    ${LWIP_SOURCE_DIR}/src/netif/*.c
)
# message(${LWIP_SOURCES})
add_library(lwip STATIC 
    lwip.c
    # ethernetif.c
    # stm32f4_eth_periph/src/stm32f4xx_hal_eth.c
    # src/core/init.c
    # src/core/init.c
    # src/core/mem.c
    # src/core/memp.c
    # src/core/netif.c
    # src/core/pbuf.c
    # src/core/udp.c
    # src/netif/ethernet.c
    ${LWIP_SOURCES}
)

# target_link_libraries(lwip PRIVATE stm32f4xx)

set(DEVICE_FAMILY STM32F439xx)

target_compile_definitions(lwip PUBLIC ${DEVICE_FAMILY})

target_include_directories(lwip PUBLIC 
    # ../bsp
    # stm32f4_eth_periph/inc
    # stm32f4_eth_periph/Legacy
    src/include/lwip
    src/include
    system/
    ./
)